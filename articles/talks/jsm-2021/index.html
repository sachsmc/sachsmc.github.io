<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Emulating a target trial to evaluate the clinical utility of a biomarker-based treatment rule</title>
    <meta charset="utf-8" />
    <meta name="author" content="Michael Sachs" />
    <meta name="date" content="2021-08-09" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="ki.css" type="text/css" />
    <link rel="stylesheet" href="ki-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Emulating a target trial to evaluate the clinical utility of a biomarker-based treatment rule
## Joint Statistical Meetings
### Michael Sachs
### 2021-08-09

---



# Other speakers

Session title: Innovative Practical Improvements in Biomarker Development and Evaluation

- Lisa McShane, Director of the Biostatistics Research Program of the National Cancer Institute
   + Biologically-informed development of treatment selection scores from high-dimensional omics data
- Mei-Yin Polley, U of Chicago and NRG Oncology
   + Two-Stage Adaptive Design for Prognostic Biomarker Signatures with a Survival Endpoint
- Kevin Dobbin, U of Georgia (USA)
   + Sample size methods for evaluation of predictive biomarkers

We are all alumni of the BRP at NCI and part of our job was to review protocols to analyze specimens from clinical trials with (often poorly thought out) plans to develop a prognostic or predictive biomarker. 

---

# Prognostic vs Predictive Biomarkers

- Prognostic:  Associated with clinical outcome in absence of therapy (natural course) OR with standard therapy all patients are likely to receive
   + Patients predicted to have highly favorable outcome on standard therapy (which could be no therapy) might avoid additional treatment
   + Patients predicted to have very poor outcome on standard therapy might consider more intense or alternative therapy (benefit of alternative must still be established)
- Predictive:  Associated with benefit or lack of benefit (potentially even harm) from a particular therapy relative to other available therapy
   + Alternate terms:  treatment-selection, treatment-guiding, treatment effect modifier
   + Will depend the particular therapies being compared, and possibly on patient population and clinical endpoints

---

# Rich Simon on black box prognostic models

"There is an **enormous gap between the large literature on prognostic models and the small number of models used in medical practice**. There are several reasons for this discrepancy. **Most prognostic models do not provide actionable information.** That is, they are based on analysis of a heterogeneous set of patients who received a variety of treatments. **Physicians want tools that help them make treatment decisions.** Unless that decision context is clearly and specifically defined at the outset of the study and used to drive the selection of the training set, the resulting model is unlikely to find medical acceptance."


Simon, R. Discussion: Class probability estimation for medical studies. _Biometrical Journal_. 2014;56(4):597–600.

---

# Assume you have a decision rule 

1. Doctors are using a risk score and 
2. Based on it, the definitions of high risk and low risk have been decided 

An example of a treatment _decision rule_ is that high risk patients receive aggressive combination treatment while low risk patients get a less costly and less toxic monotherapy treatment. 

- This is an intervention
- Its use can be harmful, useless or beneficial
- It should be evaluated like an intervention

__What do we want to estimate?__


---

# Estimand of interest

`\(\theta = E \{Y(\mbox{used decision rule})\} - E \{Y(\mbox{standard of care})\}\)`

Where `\(Y(\cdot)\)` denotes the potential outcome under the possibly hypothetical scenario where `\(\cdot\)` was the intervention (decision rule) used in the population.

Standard of care may be physician choice or treat everyone with one of the options A or B

---

# Generate evidence to support use/no use of the model

![](study.png)&lt;!-- --&gt;

---

# Where is the money for this going to come from? 

1. Very few trials of this nature are being run 
2. Most are platform studies, like Probio II
3. What do the rest of us do? 

We need preliminary evidence to support such a study. 


---

# Using an emulated trial in observational data 

Same as Hérnan and Robins (2016)

1. Use the same inclusion/exclusion criteria that a clinical trial might 
2. Define a grace period for use of the deterministic decision rule 
3. Deal with people that die/have the event prior to the end of the grace period

Different

1. The estimand is `\(E\{Y(\mbox{used decision rule})\} - E\{Y(\mbox{standard of care})\}\)`
2. since `\(E\{Y(\mbox{standard of care})\}\)` is literally what we observe, this has no confounding 
3. `\(E\{Y(\mbox{used decision rule})\}\)` can be decomposed to allow for estimation in the observed data 

---

# Estimand

`\(E\{Y(\mbox{used decision rule})\} = Pr\{\mbox{low risk}\} E\{Y(A)|\mbox{low risk}\} + Pr\{\mbox{high risk}\} E\{Y(B)|\mbox{high risk}\}.\)`

Under what conditions is this estimable?

How to estimate and do inference? 

---

# Assumptions for identification

`\(Pr\{\mbox{low risk}\} E\{Y(A)|\mbox{low risk}\} + Pr\{\mbox{high risk}\} E\{Y(B)|\mbox{high risk}\}\)`

Say we observe `\(Y_i\)` the outcome, `\(Z_i\)` the treatment actually received (A or B), `\(H_i\)` an indicator of high risk, and a set of covariates `\(C_i\)` for each subject `\(i\)`.

1. Positivity of treatment assignment: within each subgroup defined by `\(C_i\)`, there is a positive probability of receiving either treatment.
2. No unmeasured confounding, all confounders of `\(Z_i \rightarrow Y_i\)` are observed and measured without error. 
3. Correct specification of the model `\(E\{Y_i | Z_i, H_i, C_i\} = g(\beta; Z_i, H_i, C_i)\)`.

Under those assumptions, each term in the above display can be consistently estimated using `\(g\)` methods

---

# Example: Oncotype DX

![](oncotype.png)

---

## Development Process Studies

1. Assay development
    - High dimensional RT-PCR assay
    - Literature review to identify candidate genes
    - Measure gene expression of about 250 genes
    - Demonstrate acceptible measurements in FFPE breast cancer biopsy specimens
2. Signature Development
    - Multiple studies to test associations between recurrence and genes
    - Number of genes whittled down to 16 plus 5 reference genes
    - Model estimated to combine genes into a recurrence score

---

## Development Process continued


3. Assay refinement
    - New assay developed to measure only the 21 genes
    - Validated and commercialized
4. Clinical validation
    - Independent study used to validate performance of score
    - Began entering clinical practice for prognosis

---


## Continued further

5. Decision impact
    - Sought to answer: Can it be used to guide treatment?
    - Low risk patients may not need chemotherapy
    - Relation to other clinical factors (ER status, node status, stage)
6. Clinical trial (TAILORx)
    - Low risk group received hormonal therapy alone; 
    - High risk group received hormonal therapy plus chemotherapy;
    - Mid-range Recurrence Score were randomized to receive hormonal therapy with or without chemotherapy.
    - Does the use of Oncotype DX have a positive impact for patients?
    

---

# In observational data

Methods:

- Observational studies from Bioconductor that used the right assay (Affymetrix) and had treatment information
- Computed the recurrence score and used the low risk threshold of 26
- Computed pseudo-observations for recurrence free survival outcome at time `\(t\)`
- Estimated the `\(Q\)` model with the pseudo-observations as the outcome within high risk/low risk groups
- Imputed the outcomes for the treatment defined by the decision rule
- Averaged and bootstrapped
- Repeat for all `\(t\)`

---


# Oncotype DX from observational data

&lt;img src="kmonco.png" width="85%" /&gt;

---

# Sensitivity to assumptions

Needless to say, it is implausible that all confounders are observed and measured without error...

In that case, we are working on methods to compute _nonparametric bounds_ on the causal effects `\(E\{Y(A)|\mbox{low risk}\}\)` and `\(E\{Y(B)|\mbox{high risk}\}\)`. 

The idea: 

- under the assumption of unmeasured confounding,
- the observed distribution and probabilities constrain the possible values of the causal effect
- The constraints can be derived using linear programming and vertex enumeration

See Gabriel et al. (2020) and (2021), both in JASA for some examples

---

# Developing a decision rule

So far we have assumed that the biomarker is binary (high risk or low risk). With a continuous biomarker we can imagine defining a series of high vs low risk groups defined by varying a threshold. 

&lt;img src="jblfig.png" width="70%" /&gt;

---

# Multiple biomarkers

With multiple biomarkers and high-dimensional data, the optimization is much more difficult. 

Gustav Jonzon, Biostatistics PhD student at KI, is working on __reinforcement learning__ methods for optimization of treatment decision rules in such settings. 

- Develop methods to optimize prediction-based decision rules w.r.t. __individual patient expected return__, that directly target the desired causal outcome 
- Given observational data on covariate-history and outcomes, outline assumptions under which the causal effect of the decision rule is estimable 
- Under these assumptions and a suitable estimation procedure, design a loss function based on this causal estimator and a choice of method to fit the __action-value function__ of the rule


---

# Study designs

The simple trial that randomly assigns individuals to use of the decision rule versus standard of care is the most direct way to estimate `\(\theta\)`, but is it the most efficient? 

Adam Brand, Biostatistics PhD student at KI is studying these questions and more

- review the literature in order to enumerate the relevant study designs; 
- determine the target estimand in each of the designs; 
- compare these designs via simulations in various treatment scenarios (e.g., varying standard of care, the nature of the novel treatment and prediction model); 
- make recommendations and possibly suggest novel designs. 

---

# Conclusion

Some causal thinking can help clarify:

- What we want to estimate/develop to provide actionable information
- Assumptions needed to do that
- Study designs to do that efficiently

Read more about the concept in 

Sachs MC, Sjölander A, Gabriel EE. Aim for Clinical Utility, Not Just Predictive Accuracy. _Epidemiology_. 2020;31(3):359-364.

---



# Discussion

- What are the biggest current pitfalls in the development and use of clinical biomarkers?
   + What steps should researchers take to avoid making those mistakes?
   + How do these errors impact the interpretation of existing clinical biomarkers and studies using those biomarkers?
   + What can we do to push the field away from these pitfalls?


---

# Join us!

The Biostatistics Group at KI is recruiting a tenure-track assistant professor

![](qrjob.png)&lt;!-- --&gt;

Take a screenshot (Win+PrtSc on Windows, Cmd+Shift+3 on Mac, PrtSc on Linux) 

We are a small but active group, working and living conditions in Sweden are very nice

Get in touch with any questions (michael.sachs@ki.se) or @ki_meb_biostat on Twitter

Or search at https://ki.se/en/about/available-positions-at-ki



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
